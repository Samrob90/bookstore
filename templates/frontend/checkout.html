{% extends 'frontend/base/base.html' %}


{% block title %}
Newtonbookshop | Checkout
{% endblock title %}



{% block header %}
{% include 'frontend/components/header.html' %}
{% endblock header %}



{% block stylesheets %}
<link rel="stylesheet" href="{{ASSETS_ROOT}}/static/assets/css/checkout.css">

{% endblock stylesheets %}



{% block content %}


<!-- ====== MAIN CONTENT ====== -->
<div class="page-header border-bottom">
    <div class="container">
        <div class="d-md-flex justify-content-between align-items-center py-4">
            <h1 class="page-title font-size-3 font-weight-medium m-0 text-lh-lg text-left">checkout</h1>
            <nav class="woocommerce-breadcrumb font-size-2">
                <a href="{% url 'home' %}" class="h-primary">Home</a>
                <span class="breadcrumb-separator mx-1"><i class="fas fa-angle-right"></i></span>
                <a href="{% url 'shop' %}" class="h-primary">Shop</a>
                <span class="breadcrumb-separator mx-1"><i class="fas fa-angle-right"></i></span>checkout
            </nav>
        </div>
    </div>
</div>
<div id="content" class="site-content space-bottom-3 " style="background-color:#f5f5f5;">
    <div class="processing">
        <div class="proccessing_content text-center">
            <div class="d-flex justify-content-center">
                <div class="spinner-border" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
            <br>
            <h4>Order processing...</h4>
            <p>This may take few seconds, do not close this window.</p>
        </div>
    </div>
    <div class="col-full container">
        <div id="primary" class="content-area">
            <main id="main" class="site-main">
                <form action="" method="post" id="checkout_form">
                    <div class="row p-4" style="margin: 0 auto;">

                        <!-- first seconde -->
                        <div class="col-lg-6">
                            <!-- <h4 class="text-left">Checkout</h4> -->
                            {% if request.user.email and addresses.count > 0 %}
                            <div class="card  border-0 fetch_address">
                                <div class="card-header border-0 pl-0" style=" background-color:#f5f5f5;">
                                    <h4 style="display: inline-block;">Select shipping address</h4> <span
                                        style="float: right;font-weight:bold;cursor:pointer;"
                                        class="text-info new_address"><svg xmlns="http://www.w3.org/2000/svg" width="21"
                                            height="21" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                                            <line x1="12" y1="5" x2="12" y2="19"></line>
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                        </svg> New address</span> <span
                                        style="float: right;font-weight:bold;cursor:pointer;"
                                        class="text-info select_user_address d-none">Select address</span>
                                    <p class="text-danger select_address_error d-none"></p>
                                </div>
                                <div class="card-body p-0" style="background-color:#f5f5f5;">
                                    <div class="select_address_section">
                                        {% for address in addresses %}

                                        <div class="p-2 mb-2  shadow-sm bg-white border-1">
                                            <div class="form-check">
                                                <input class="form-check-input addressid" type="radio" name="addressid"
                                                    id="flexRadioDefault{{forloop.counter}}" value="{{address.pk}}">
                                                <label class="form-check-label"
                                                    for="flexRadioDefault{{forloop.counter}}">
                                                    <h5>{{address.first_name}} {{address.last_name}}</h5>
                                                    <p class="text-muted">{{address.address1}}
                                                        {{address.region_or_state}} ,{{address.country}} <br>
                                                        {{address.phonenumber}}
                                                    </p>
                                                </label>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>

                                    <div class="add_address_section d-none">
                                        {% include 'frontend/components/address.html' %}
                                    </div>
                                </div>

                            </div>

                            {% endif %}





                            <div class="card border-0 mt-6 select_payment_section">
                                <div class="card-header border-0 pl-0" style="background-color:#f5f5f5;">
                                    <h4>Select a payment method</h4>
                                </div>
                                <div class="card-body p-0 rounded-1" style="background-color:#f5f5f5;">
                                    <!-- Payment method -->

                                    <div class="card " id="pay_momo">
                                        <div class="card-body p-2 pl-4 select_payment_active">
                                            <span class="pr-2">Momo or credit/debit card </span><img
                                                src="{{ASSETS_ROOT}}/static/assets/img/transaction/pay5.jpg"
                                                alt="mobile money" height="40px">
                                            <span style="float:right;" class="selected_icone_pay_momo"><svg
                                                    xmlns="http://www.w3.org/2000/svg" width="35" height="35"
                                                    viewBox="0 0 24 24" fill="none" stroke="#7ed321" stroke-width="2"
                                                    stroke-linecap="round" stroke-linejoin="round">
                                                    <polyline points="20 6 9 17 4 12"></polyline>
                                                </svg></span>
                                        </div>
                                    </div>
                                    <!-- Payment method  -->

                                    <input type="hidden" name="payment_method" id="payment_method"
                                        value="pay_with_momo">

                                    <!-- Payment method -->
                                    <div class="card mt-2 " id="pay_cash">
                                        <div class="card-body p-2 pl-4">
                                            <span class="pr-2">Pay cash on delivery </span><img
                                                src="{{ASSETS_ROOT}}/static/assets/img/transaction/paycash.png"
                                                alt=" mobile money" srcset="" height="40px">
                                            <span style="float:right;" class="selected_icone_pay_cash d-none"><svg
                                                    xmlns="http://www.w3.org/2000/svg" width="35" height="35"
                                                    viewBox="0 0 24 24" fill="none" stroke="#7ed321" stroke-width="2"
                                                    stroke-linecap="round" stroke-linejoin="round">
                                                    <polyline points="20 6 9 17 4 12"></polyline>
                                                </svg></span>
                                        </div>
                                    </div>

                                </div>

                                <br>
                            </div>



                        </div>



                        <div class="col-lg-6 mt-4">
                            <div class="card shadow-sm">
                                <div class="card-header bg-white">
                                    Your order
                                </div>
                                <div class="card-body">
                                    <table class="shop_table woocommerce-checkout-review-order-table w-100">
                                        <thead class="d-none">
                                            <tr>
                                                <th class="product-name">Product</th>
                                                <th class="product-total">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody class="mb-2">


                                            {% for item in cart %}


                                            <tr class="cart_item">
                                                <td class="product-name pr-4 pb-4" style="font-size:15px;">
                                                    {{item.booktitle}}&nbsp; <strong class="product-quantity">Ã—
                                                        {{item.bookquantity}}</strong>
                                                </td>
                                                <td class="product-total pb-4">
                                                    <span class="woocommerce-Price-amount amount"><span
                                                            class="woocommerce-Price-currencySymbol">â‚µ</span>{{item.bookprice}}</span>
                                                </td>

                                            </tr>
                                            {% endfor %}



                                        </tbody>
                                        <tfoot class="">

                                            <tr class="cart-subtotal "
                                                style="border-top:1px solid lightgray!important;">
                                                <td class="pt-4">Delivery fees</td>
                                                <td class="pb-2 pt-4">
                                                    <span class="woocommerce-Price-amount amount">
                                                        <span
                                                            class="woocommerce-Price-currencySymbol">â‚µ&nbsp;</span><span
                                                            id="shipping_fee">0</span>

                                                    </span>
                                                </td>
                                            </tr>

                                            <tr class="order-total">
                                                <th class="pt-2">Subtotal</th>
                                                <td class="pt-2">

                                                    <span class="woocommerce-Price-amount amount">
                                                        <span
                                                            class="woocommerce-Price-currencySymbol">â‚µ&nbsp;</span><span
                                                            id="subtotal"
                                                            subtotal="{{cart_price_total}}">{{cart_price_total}}</span>
                                                    </span>
                                                </td>
                                            </tr>


                                        </tfoot>

                                    </table>
                                </div>

                                <!-- cuppon -->
                                <div class="card mt-0 coupon_section">
                                    <div class="discount">
                                        <div class="woocommerce-info p-4 bg-white">Have a coupon?
                                            <a class="showcoupon" href="#">
                                                Click here to enter your code
                                            </a>
                                        </div>

                                        <form class="mt-0 p-4 bg-white border" method="post">
                                            <p id="coupon_error" class="text-danger ml-4"></p>
                                            <div class="row d-flex coupon_toggle" style="display: none!important;">
                                                <p
                                                    class="col-md-4 col-sm-6 d-inline form-row form-row-first mb-3 ml-4 mb-md-0">
                                                    <input type="text" name="coupon_code1"
                                                        class="input-text form-control" placeholder="Coupon code"
                                                        id="coupon_code1">
                                                </p>

                                                <p class="form-row form-row-last ml-2">

                                                    <button type="submit" name="apply_coupon" id="apply_coupon"
                                                        class="button border-0 height-4 btn btn-dark rounded-0"><img
                                                            src="{{ASSETS_ROOT}}/static/assets/img/720.gif" alt="loader"
                                                            width="50px" height="20px" class="pr-2 c_loader ">
                                                        <span id="c_loader_text">Apply coupon</span></button>

                                                    <!-- <input type="submit"
                                                        class="button border-0 height-4 btn btn-dark rounded-0"
                                                        name="apply_coupon" id="apply_coupon" value="Apply coupon"> -->
                                                </p>
                                            </div>

                                            <div class="clear"></div>
                                        </form>
                                    </div>


                                    <div class="applied_coupon pl-4 pt-2 d-none">
                                        <p class="text-success">Success!! you saved : GHS <span id="discount__"></span>
                                        </p>
                                    </div>


                                    <div class="p-4d875 border getdiscount" discount="">
                                        <table class="shop_table shop_table_responsive">
                                            <tbody>
                                                <tr class="order-total">
                                                    <th>TOTAL </th>
                                                    <td data-title="Total"><strong><span
                                                                class="woocommerce-Price-amount amount"><span
                                                                    class="woocommerce-Price-currencySymbol">&nbsp;GHS
                                                                </span><span id="Total"></span></span></strong>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>


                                </div>
                                <input type="hidden" name="coupon_code_input" value="">
                                <input type="hidden" name="checkout" value="checkout_erknsojdnfknksn">




                                <!-- <div class="p-4d875 border">
                            <table class="shop_table shop_table_responsive">
                                <tbody>
                                    <tr class="order-total">
                                        <th class="pt-2">Subtotal</th>
                                        <td class="pt-2">

                                            <span class="woocommerce-Price-amount amount">
                                                <span class="woocommerce-Price-currencySymbol">â‚µ&nbsp;</span><span
                                                    id="subtotal"
                                                    subtotal="{{cart_price_total}}">{{cart_price_total}}</span>
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div> -->



                            </div>
                            <div class="next_step mt-4">
                                <button type="submit"
                                    class="button border-0 height-4 btn btn-dark rounded-0 form-control proceed_to_next_step">CONTINUE</button>
                            </div>




                        </div>

                        <!-- second -->
                    </div>
                </form> <!-- #post-## -->
            </main>
            <!-- #main -->
        </div>
        <!-- #primary -->
    </div>
    <!-- .col-full -->
</div>



{% endblock content %}



{% block javascripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.1/js.cookie.min.js" type="text/javascript"></script>
<script src="{{ASSETS_ROOT}}/static/assets/js/checkout.js"></script>
{% endblock javascripts %}